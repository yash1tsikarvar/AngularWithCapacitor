!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs/BehaviorSubject"),require("tslib"),require("rxjs/ReplaySubject"),require("rxjs/operators/filter"),require("@angular/common"),require("@angular/router"),require("rxjs/operators/delay"),require("rxjs/operators/map")):"function"==typeof define&&define.amd?define("angulartics2",["exports","@angular/core","rxjs/BehaviorSubject","tslib","rxjs/ReplaySubject","rxjs/operators/filter","@angular/common","@angular/router","rxjs/operators/delay","rxjs/operators/map"],t):t(e.angulartics2={},e.ng.core,e.Rx,e.tslib,e.Rx,e.Rx.Observable.prototype,e.ng.common,e.ng.router,e.Rx.Observable.prototype,e.Rx.Observable.prototype)}(this,function(e,t,r,o,a,n,i,s,c,u){"use strict";var p=function(){this.pageTracking={autoTrackVirtualPages:!0,basePath:"",excludedRoutes:[],clearIds:!1,clearHash:!1,clearQueryParams:!1,idsRegExp:/^\d+$|^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/},this.developerMode=!1,this.ga={},this.appInsights={},this.gtm={}},l=new t.InjectionToken("ANGULARTICS2"),g=function(){function e(){}return e.prototype.trackLocation=function(e){return new r.BehaviorSubject({url:"/"})},e.prototype.prepareExternalUrl=function(e){return e},e}(),h=function(){function e(e,t){var r=this;this.tracker=e,this.pageTrack=new a.ReplaySubject(10),this.eventTrack=new a.ReplaySubject(10),this.exceptionTrack=new a.ReplaySubject(10),this.setAlias=new a.ReplaySubject(10),this.setUsername=new a.ReplaySubject(10),this.setUserProperties=new a.ReplaySubject(10),this.setUserPropertiesOnce=new a.ReplaySubject(10),this.setSuperProperties=new a.ReplaySubject(10),this.setSuperPropertiesOnce=new a.ReplaySubject(10),this.userTimings=new a.ReplaySubject(10);var n=new p;this.settings=Object.assign({},n,t.settings),this.settings.pageTracking=Object.assign({},n.pageTracking,t.settings.pageTracking),this.tracker.trackLocation(this.settings).subscribe(function(e){return r.trackUrlChange(e.url)})}return e.prototype.virtualPageviews=function(e){this.settings.pageTracking.autoTrackVirtualPages=e},e.prototype.excludeRoutes=function(e){this.settings.pageTracking.excludedRoutes=e},e.prototype.withBase=function(e){this.settings.pageTracking.basePath=e},e.prototype.clearIds=function(e){this.settings.pageTracking.clearIds=e},e.prototype.developerMode=function(e){this.settings.developerMode=e},e.prototype.filterDeveloperMode=function(){var r=this;return n.filter(function(e,t){return!r.settings.developerMode})},e.prototype.trackUrlChange=function(e){if(this.settings.pageTracking.autoTrackVirtualPages&&!this.matchesExcludedRoute(e)){var t=this.clearUrl(e),r=void 0;r=this.settings.pageTracking.basePath.length?this.settings.pageTracking.basePath+t:this.tracker.prepareExternalUrl(t),this.pageTrack.next({path:r})}},e.prototype.matchesExcludedRoute=function(e){try{for(var t=o.__values(this.settings.pageTracking.excludedRoutes),r=t.next();!r.done;r=t.next()){var n=r.value;if(n instanceof RegExp&&n.test(e)||-1!==e.indexOf(n))return!0}}catch(s){a={error:s}}finally{try{r&&!r.done&&(i=t["return"])&&i.call(t)}finally{if(a)throw a.error}}return!1;var a,i},e.prototype.clearUrl=function(e){var t=this;return this.settings.pageTracking.clearIds||this.settings.pageTracking.clearQueryParams||this.settings.pageTracking.clearHash?e.split("/").map(function(e){return t.settings.pageTracking.clearQueryParams?e.split("?")[0]:e}).map(function(e){return t.settings.pageTracking.clearHash?e.split("#")[0]:e}).filter(function(e){return!t.settings.pageTracking.clearIds||!e.match(t.settings.pageTracking.idsRegExp)}).join("/"):e},e}();h.decorators=[{type:t.Injectable}],h.ctorParameters=function(){return[{type:g},{type:undefined,decorators:[{type:t.Inject,args:[l]}]}]};var f=function(){function e(e,t){this.router=e,this.location=t}return e.prototype.trackLocation=function(e){return this.router.events.pipe(n.filter(function(e){return e instanceof s.NavigationEnd}),n.filter(function(){return!e.developerMode}),u.map(function(e){return{url:e.urlAfterRedirects}}),c.delay(0))},e.prototype.prepareExternalUrl=function(e){return this.location.prepareExternalUrl(e)},e}();f.decorators=[{type:t.Injectable}],f.ctorParameters=function(){return[{type:s.Router},{type:i.Location}]};var d=function(){function e(e,t,r){this.elRef=e,this.angulartics2=t,this.renderer=r,this.angularticsProperties={}}return e.prototype.ngAfterContentInit=function(){var t=this;this.renderer.listen(this.elRef.nativeElement,this.angulartics2On||"click",function(e){return t.eventTrack(e)})},e.prototype.eventTrack=function(e){var t=this.angularticsAction,r=Object.assign({},this.angularticsProperties,{eventType:e.type});this.angularticsCategory&&(r.category=this.angularticsCategory),this.angularticsLabel&&(r.label=this.angularticsLabel),this.angularticsValue&&(r.value=this.angularticsValue),this.angulartics2.eventTrack.next({action:t,properties:r})},e}();d.decorators=[{type:t.Injectable},{type:t.Directive,args:[{selector:"[angulartics2On]"}]}],d.ctorParameters=function(){return[{type:t.ElementRef},{type:h},{type:t.Renderer2}]},d.propDecorators={angulartics2On:[{type:t.Input,args:["angulartics2On"]}],angularticsAction:[{type:t.Input}],angularticsCategory:[{type:t.Input}],angularticsLabel:[{type:t.Input}],angularticsValue:[{type:t.Input}],angularticsProperties:[{type:t.Input}]};var y=function(){};y.decorators=[{type:t.NgModule,args:[{declarations:[d],exports:[d]}]}];var v=function(){function r(){}return r.forRoot=function(e,t){return void 0===t&&(t={}),{ngModule:r,providers:o.__spread([{provide:l,useValue:{providers:e,settings:t}},h,{provide:g,useClass:f}],e)}},r}();v.decorators=[{type:t.NgModule,args:[{imports:[y],exports:[d]}]}],e.Angulartics2=h,e.Angulartics2Module=v,e.ANGULARTICS2_TOKEN=l,e.Angulartics2On=d,e.Angulartics2OnModule=y,e.RouterlessTracking=g,e.AngularRouterTracking=f,e.DefaultConfig=p,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=angulartics2.umd.min.js.map
